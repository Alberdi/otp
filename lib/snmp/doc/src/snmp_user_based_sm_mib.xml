<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE erlref SYSTEM "erlref.dtd">

<erlref>
  <header>
    <copyright>
      <year>1999</year><year>2024</year>
      <holder>Ericsson AB. All Rights Reserved.</holder>
    </copyright>
    <legalnotice>
      Licensed under the Apache License, Version 2.0 (the "License");
      you may not use this file except in compliance with the License.
      You may obtain a copy of the License at
 
          http://www.apache.org/licenses/LICENSE-2.0

      Unless required by applicable law or agreed to in writing, software
      distributed under the License is distributed on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      See the License for the specific language governing permissions and
      limitations under the License.
    
    </legalnotice>

    <title>snmp_user_based_sm_mib</title>
    <prepared></prepared>
    <responsible></responsible>
    <docno></docno>
    <approved></approved>
    <checked></checked>
    <date></date>
    <rev></rev>
    <file>snmp_user_based_sm_mib.xml</file>
  </header>
  <module since="">snmp_user_based_sm_mib</module>
  <modulesummary>Instrumentation Functions for SNMP-USER-BASED-SM-MIB</modulesummary>
  <description>
    <p>The module <c>snmp_user_based_sm_mib</c> implements the instrumentation 
    functions for the SNMP-USER-BASED-SM-MIB, and functions for configuring 
    the database. </p>
    <p>Note that authentication has been extended according to RFC 7860
    (SNMP-USM-HMAC-SHA2-MIB). </p>
    <p>The configuration files are described in the SNMP User's Manual.</p>
  </description>

  <datatypes>
    <datatype>
      <name name="name"/>
      <desc>
	<note>
	  <p>
	    "A human readable string representing the name of the user.
             This is the (User-based Security) Model dependent
	     security ID." </p>
	</note>
	<p>
	  <c><![CDATA[SnmpAdminString (SIZE(1..32))]]></c>
	</p>
      </desc>
    </datatype>

    <datatype>
      <name name="clone_from"/>
      <desc>
	<note>
	  <p>
	    "A pointer to another conceptual row in this
             usmUserTable.  The user in this other conceptual
             row is called the clone-from user." </p>
	</note>
	<p>
	  <c><![CDATA[RowPointer]]></c>
	</p>
      </desc>
    </datatype>

    <datatype>
      <name name="auth_protocol"/>
      <desc>
	<note>
	  <p>
	    "An indication of whether messages sent on behalf of
             this user to/from the SNMP engine identified by
             usmUserEngineID, can be authenticated, and if so,
	     the type of authentication protocol which is used."
	  </p>
	</note>
	<note>
	  <p>
	    Some of the entries of this tyype are actually defined by
	    the SNMP-USM-HMAC-SHA2-MIB mib.
	  </p>
	</note>
	<p>
	  <c><![CDATA[AutonomousType]]></c>
	</p>
      </desc>
    </datatype>

    <datatype>
      <name name="key_change"/>
      <desc>
	<note>
	  <p>
	    "Every definition of an object with this syntax must identify
             a protocol P, a secret key K, and a hash algorithm H
             that produces output of L octets." </p>
	</note>
	<p>
	  <c><![CDATA[OCTET STRING]]></c>
	</p>
      </desc>
    </datatype>

    <datatype>
      <name name="priv_protocol"/>
      <desc>
	<note>
	  <p>
	    "An indication of whether messages sent on behalf of
             this user to/from the SNMP engine identified by
             usmUserEngineID, can be protected from disclosure,
             and if so, the type of privacy protocol which is used." </p>
	</note>
	<note>
	  <p>
	    Some of the entries of this tyype are actually defined by
	    the SNMP-USM-AES-MIB mib.
	  </p>
	</note>
	<p>
	  <c><![CDATA[AutonomousType]]></c>
	</p>
      </desc>
    </datatype>

    <datatype>
      <name name="public"/>
      <desc>
	<!--
	<note>
	  <p>
	    TBD
	  </p>
	</note>
	-->
	<p>
	  <c><![CDATA[OCTET STRING (SIZE(0..32))]]></c>
	</p>
      </desc>
    </datatype>

    <datatype>
      <name name="auth_key"/>
      <desc>
	<p>The size/length of the list depends on auth protocol: </p>
	<pre>
               Size any for usmNoAuthProtocol
               Size 16  for usmHMACMD5AuthProtocol
               Size 20  for usmHMACSHAAuthProtocol
               Size 28  for usmHMAC128SHA224AuthProtocol
               Size 32  for usmHMAC192SHA256AuthProtocol
               Size 48  for usmHMAC256SHA384AuthProtocol
	       Size 64  for usmHMAC384SHA512AuthProtocol
	</pre>
      </desc>
    </datatype>

    <datatype>
      <name name="priv_key"/>
      <desc>
	<p>The size/length of the list depends on priv protocol: </p>
	<pre>
	       Size any for usmNoPrivProtocol
               Size 16  for usmDESPrivProtocol
               Size 16  for usmAesCfb128Protocol
	</pre>
      </desc>
    </datatype>

  </datatypes>

  <funcs>
    <func>
      <name name="configure" arity="1" clause_i="1" since=""/>
      <fsummary>Configure the SNMP-USER-BASED-SM-MIB</fsummary>
      <desc>
	<p>This function is called from the supervisor at system
	start-up. </p>
	<p>Inserts all data in the configuration files into the
	database and destroys all old rows with StorageType
	<c>volatile</c>.  The rows created from the configuration file
	will have StorageType <c>nonVolatile</c>. </p>
	<p>All <c>snmp</c> counters are set to zero. </p>
	<p>If an error is found in the configuration file, it is
	reported using the function <c>config_err/2</c> of the error
	report module, and the function fails with the reason 
	<c>configuration_error</c>. </p>
	<p><c>ConfDir</c> is a string which points to the directory
	where the configuration files are found. </p>
	<p>The configuration file read is: <c>usm.conf</c>. </p>
      </desc>
    </func>
    <func>
      <name since="">reconfigure(ConfDir) -> void()</name>
      <fsummary>Configure the SNMP-USER-BASED-SM-MIB</fsummary>
      <type>
	<v>ConfDir = string()</v>
      </type>
      <desc>
	<p>Inserts all data in the configuration files into the
	database and destroys all old data, including the rows with
	StorageType <c>nonVolatile</c>.  The rows created from the
	configuration file will have StorageType <c>nonVolatile</c>.
	</p>
	<p>Thus, the data in the SNMP-USER-BASED-SM-MIB, after this
	function has been called, is the data from the configuration
	files.
	</p>
	<p>All <c>snmp</c> counters are set to zero.
	</p>
	<p>If an error is found in the configuration file, it is
	reported using the function <c>config_err/2</c> of the error
	report module, and the function fails with the reason 
	<c>configuration_error</c>.
	</p>
	<p><c>ConfDir</c> is a string which points to the directory
	where the configuration files are found.
	</p>
	<p>The configuration file read is: <c>usm.conf</c>. </p>

	<marker id="add_user"></marker>
      </desc>
    </func>

    <func>
      <name name="add_user" arity="13" clause_i="1" since=""/>
      <fsummary>Add one user</fsummary>
      <desc>
	<p>Adds a USM security data (user) to the agent config. 
	Equivalent to one line in the <c>usm.conf</c> file.</p>
	<marker id="delete_user"></marker>
      </desc>
    </func>
    <func>
      <name since="">delete_user(Key) -> Ret</name>
      <fsummary>Delete one user</fsummary>
      <type>
	<v>Key = term()</v>
	<v>Ret = ok | {error, Reason}</v>
	<v>Reason = term()</v>
      </type>
      <desc>
	<p>Delete a USM security data (user) from the agent config.</p>
      </desc>
    </func>
  </funcs>
  
</erlref>

